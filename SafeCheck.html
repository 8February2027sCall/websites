<!DOCTYPE html>
<html lang="fr">
<head>
    <!--
        8 February 2027's Call - SafeCheck
        Interface de scan antipirate / antimalware
        Style : invite de commande, minimal, sombre
        Auteur : Valentin / FUTURE VAL CORP
    -->

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>8 February 2027's Call — SafeCheck</title>

    <!-- Icône de la page -->
    <link rel="icon" type="image/png" href="827scall Logo (Carré).png">

    <!-- Police titres : Inndam Extended (placeholder, à remplacer par la vraie fonte si nécessaire) -->
    <!-- Exemple : 
    <link rel="stylesheet" href="inndam-extended.css">
    -->

    <style>
        /* ===========================
           RESET DE BASE
        ============================ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            height: 100%;
            background-color: #050505;
            color: #e5e5e5;
            font-family: monospace;
        }

        body {
            display: flex;
            flex-direction: column;
        }

        /* ===========================
           TYPOGRAPHIE
        ============================ */

        .title-font {
            /* Placeholder pour "Inndam Extended" */
            font-family: "Inndam Extended", system-ui, sans-serif;
            letter-spacing: 0.12em;
            text-transform: uppercase;
        }

        .mono-font {
            font-family: monospace;
        }

        /* ===========================
           LAYOUT GLOBAL
        ============================ */

        .terminal-wrapper {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 16px;
            background-color: #050505;
        }

        .terminal-frame {
            border: 1px solid #333;
            background-color: #050505;
            padding: 12px;
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .terminal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .terminal-header-left {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .terminal-lights {
            display: flex;
            gap: 6px;
        }

        .terminal-light {
            width: 10px;
            height: 10px;
            border-radius: 50%;
        }

        .light-red {
            background-color: #ff4b4b;
        }

        .light-yellow {
            background-color: #ffd95e;
        }

        .light-green {
            background-color: #4bff7a;
        }

        .terminal-title {
            font-size: 0.85rem;
            color: #b0b0b0;
        }

        .terminal-header-right {
            font-size: 0.75rem;
            color: #666;
        }

        .terminal-body {
            flex: 1;
            border-top: 1px solid #333;
            padding-top: 8px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            overflow: auto;
        }

        /* ===========================
           BANNIÈRE / TITRE
        ============================ */

        .banner {
            border-bottom: 1px dashed #333;
            padding-bottom: 8px;
            margin-bottom: 8px;
        }

        .banner-title {
            font-size: 1.1rem;
            color: #f5f5f5;
        }

        .banner-subtitle {
            font-size: 0.8rem;
            color: #888;
            margin-top: 2px;
        }

        .banner-tagline {
            font-size: 0.75rem;
            color: #666;
            margin-top: 4px;
        }

        /* ===========================
           ZONE DE LOG / CONSOLE
        ============================ */

        .console-output {
            flex: 1;
            background-color: #050505;
            border: 1px solid #222;
            padding: 8px;
            font-size: 0.8rem;
            overflow-y: auto;
            white-space: pre-wrap;
        }

        .console-line {
            margin-bottom: 2px;
        }

        .console-prefix {
            color: #4bff7a;
        }

        .console-warning {
            color: #ffd95e;
        }

        .console-danger {
            color: #ff4b4b;
        }

        .console-info {
            color: #5ea9ff;
        }

        .console-muted {
            color: #666;
        }

        .console-critical {
            color: #ff4b4b;
            font-weight: bold;
        }

        /* ===========================
           FORMULAIRE DE SCAN
        ============================ */

        .scan-panel {
            border: 1px solid #222;
            padding: 8px;
            display: flex;
            flex-direction: column;
            gap: 8px;
            background-color: #050505;
        }

        .scan-panel-title {
            font-size: 0.9rem;
            color: #f5f5f5;
        }

        .scan-panel-section {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .scan-label {
            font-size: 0.75rem;
            color: #aaa;
        }

        .scan-textarea {
            width: 100%;
            min-height: 80px;
            max-height: 200px;
            resize: vertical;
            background-color: #050505;
            color: #e5e5e5;
            border: 1px solid #333;
            padding: 6px;
            font-size: 0.8rem;
            font-family: monospace;
        }

        .scan-file-input {
            font-size: 0.75rem;
            color: #e5e5e5;
            background-color: #050505;
            border: 1px solid #333;
            padding: 4px;
        }

        .scan-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 4px;
        }

        .btn {
            padding: 4px 10px;
            font-size: 0.75rem;
            border: 1px solid #444;
            background-color: #050505;
            color: #e5e5e5;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 0.08em;
        }

        .btn:hover {
            background-color: #111;
        }

        .btn-primary {
            border-color: #4bff7a;
            color: #4bff7a;
        }

        .btn-warning {
            border-color: #ffd95e;
            color: #ffd95e;
        }

        .btn-danger {
            border-color: #ff4b4b;
            color: #ff4b4b;
        }

        .btn-muted {
            border-color: #555;
            color: #777;
        }

        /* ===========================
           STATUTS / BADGES
        ============================ */

        .status-row {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 4px;
        }

        .status-badge {
            padding: 2px 6px;
            font-size: 0.7rem;
            border-radius: 2px;
            border: 1px solid #444;
        }

        .status-safe {
            color: #4bff7a;
            border-color: #4bff7a;
        }

        .status-normal {
            color: #ffd95e;
            border-color: #ffd95e;
        }

        .status-danger {
            color: #ff4b4b;
            border-color: #ff4b4b;
        }

        .status-virus {
            color: #ff4b4b;
            border-color: #ff4b4b;
            animation: blink-red 0.36s infinite alternate;
        }

        .status-unknown-normal {
            color: #ffb347;
            border-color: #ffb347;
        }

        .status-unknown-suspect {
            color: #ffb347;
            border-color: #ffb347;
            animation: blink-orange 0.36s infinite alternate;
        }

        @keyframes blink-red {
            0% { opacity: 1; }
            100% { opacity: 0.2; }
        }

        @keyframes blink-orange {
            0% { opacity: 1; }
            100% { opacity: 0.2; }
        }

        /* ===========================
           POPUPS / ALERTES
        ============================ */

        .overlay {
            position: fixed;
            inset: 0;
            background-color: rgba(0, 0, 0, 0.85);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 999;
        }

        .overlay.visible {
            display: flex;
        }

        .popup {
            background-color: #050505;
            border: 1px solid #444;
            padding: 16px;
            max-width: 480px;
            width: 90%;
            box-shadow: 0 0 0 1px #111;
        }

        .popup-header {
            margin-bottom: 8px;
        }

        .popup-title {
            font-size: 0.95rem;
        }

        .popup-body {
            font-size: 0.8rem;
            color: #ddd;
            margin-bottom: 8px;
        }

        .popup-footer {
            display: flex;
            justify-content: flex-end;
            gap: 8px;
        }

        .popup-critical {
            border-color: #ff4b4b;
            box-shadow: 0 0 12px rgba(255, 75, 75, 0.5);
        }

        .popup-warning {
            border-color: #ffd95e;
            box-shadow: 0 0 12px rgba(255, 217, 94, 0.4);
        }

        .popup-title-danger {
            color: #ff4b4b;
        }

        .popup-title-warning {
            color: #ffd95e;
        }

        .popup-countdown {
            font-size: 0.8rem;
            color: #ff4b4b;
            margin-top: 4px;
        }

        /* ===========================
           PIED DE PAGE
        ============================ */

        .footer {
            border-top: 1px solid #222;
            padding: 4px 16px;
            font-size: 0.7rem;
            color: #555;
            display: flex;
            justify-content: space-between;
            background-color: #050505;
        }

        .footer-left {
            display: flex;
            gap: 8px;
        }

        .footer-right {
            text-align: right;
        }

        .footer-strong {
            color: #888;
        }

        .footer-link {
            color: #5ea9ff;
            text-decoration: none;
        }

        .footer-link:hover {
            text-decoration: underline;
        }

        /* ===========================
           SCROLLBAR (OPTIONNEL)
        ============================ */

        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }

        ::-webkit-scrollbar-track {
            background: #050505;
        }

        ::-webkit-scrollbar-thumb {
            background: #333;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #444;
        }

        /* ===========================
           RESPONSIVE
        ============================ */

        @media (max-width: 768px) {
            .terminal-wrapper {
                padding: 8px;
            }

            .terminal-frame {
                padding: 8px;
            }

            .banner-title {
                font-size: 0.95rem;
            }

            .scan-textarea {
                min-height: 70px;
            }
        }

        @media (max-width: 480px) {
            .terminal-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 4px;
            }

            .footer {
                flex-direction: column;
                gap: 4px;
            }

            .footer-right {
                text-align: left;
            }
        }
    </style>
</head>
<body class="mono-font">
    <div class="terminal-wrapper">
        <div class="terminal-frame">
            <!-- ===========================
                 EN-TÊTE TYPE TERMINAL
            ============================ -->
            <div class="terminal-header">
                <div class="terminal-header-left">
                    <div class="terminal-lights">
                        <div class="terminal-light light-red"></div>
                        <div class="terminal-light light-yellow"></div>
                        <div class="terminal-light light-green"></div>
                    </div>
                    <div class="terminal-title mono-font">
                        8 February 2027's Call — SafeCheck.exe
                    </div>
                </div>
                <div class="terminal-header-right mono-font">
                    MODE : ANALYSE ANTIPIRATE / ANTIMALWARE
                </div>
            </div>

            <!-- ===========================
                 CORPS DU TERMINAL
            ============================ -->
            <div class="terminal-body">
                <!-- BANNIÈRE -->
                <div class="banner">
                    <div class="banner-title title-font">
                        8 February 2027's Call — SafeCheck
                    </div>
                    <div class="banner-subtitle mono-font">
                        Interface de scan antipirate / antimalware — style invite de commande.
                    </div>
                    <div class="banner-tagline mono-font">
                        ATTENTION : Cette interface doit être reliée à un backend antivirus / sandbox RÉEL pour un scan effectif.
                    </div>
                </div>

                <!-- ZONE DE LOG / CONSOLE -->
                <div id="consoleOutput" class="console-output mono-font">
                    <div class="console-line console-muted">
                        [BOOT] Initialisation de SafeCheck...
                    </div>
                    <div class="console-line console-muted">
                        [INFO] Chargement des modules : Analyse Texte, Analyse Fichier, Analyse Globale.
                    </div>
                    <div class="console-line console-muted">
                        [INFO] Rappel : cette page est une interface. Le scan réel nécessite un backend spécialisé (antivirus, sandbox).
                    </div>
                    <div class="console-line console-muted">
                        [READY] En attente d'entrée utilisateur.
                    </div>
                </div>

                <!-- PANNEAU DE SCAN -->
                <div class="scan-panel mono-font">
                    <div class="scan-panel-title title-font">
                        > Zone de Scan
                    </div>

                    <!-- SECTION TEXTE / LIEN -->
                    <div class="scan-panel-section">
                        <label for="textInput" class="scan-label">
                            [1] Zone de texte (lien ou contenu à analyser)
                        </label>
                        <textarea id="textInput" class="scan-textarea" placeholder="Collez ici un lien ou un texte suspect (ex : https://exemple.com)..."></textarea>
                    </div>

                    <!-- SECTION FICHIER -->
                    <div class="scan-panel-section">
                        <label for="fileInput" class="scan-label">
                            [2] Zone d'importation de fichier (tout type)
                        </label>
                        <input id="fileInput" type="file" class="scan-file-input">
                    </div>

                    <!-- ACTIONS -->
                    <div class="scan-actions">
                        <button id="btnScan" class="btn btn-primary">
                            Lancer le Scan (3 étapes)
                        </button>
                        <button id="btnClear" class="btn btn-muted">
                            Effacer la Console
                        </button>
                        <button id="btnSimulateBackend" class="btn btn-warning">
                            Info Backend
                        </button>
                    </div>

                    <!-- STATUTS -->
                    <div class="scan-panel-section">
                        <span class="scan-label">
                            [3] Statuts possibles :
                        </span>
                        <div class="status-row">
                            <span class="status-badge status-safe">SAFE (Vert)</span>
                            <span class="status-badge status-normal">NORMAL (Jaune)</span>
                            <span class="status-badge status-danger">DANGEREUX (Rouge)</span>
                            <span class="status-badge status-virus">VIRUS / MALWARE (Rouge clignotant)</span>
                            <span class="status-badge status-unknown-normal">INCONNU MAIS NORMAL (Orange)</span>
                            <span class="status-badge status-unknown-suspect">INCONNU MAIS SUSPECT (Orange clignotant)</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ===========================
         POPUP DANGER / INCONNU-NORMAL
    ============================ -->
    <div id="popupWarningOverlay" class="overlay">
        <div class="popup popup-warning">
            <div class="popup-header">
                <div class="popup-title popup-title-warning title-font">
                    ALERTE — Lien/Fichier Dangereux ou Inconnu-Normal
                </div>
            </div>
            <div class="popup-body">
                Le scan a détecté un lien ou un fichier classé comme
                <span class="console-danger">Dangereux</span> ou
                <span class="console-warning">Inconnu mais Normal</span>.<br><br>
                Recommandations :
                <ul style="margin-top: 4px; padding-left: 18px;">
                    <li>Ne cliquez pas sur ce lien sans certitude.</li>
                    <li>Vérifiez l'origine du fichier ou du lien.</li>
                    <li>Utilisez un antivirus ou une sandbox pour une analyse approfondie.</li>
                </ul>
            </div>
            <div class="popup-footer">
                <button id="popupWarningClose" class="btn btn-warning">
                    Compris
                </button>
            </div>
        </div>
    </div>

    <!-- ===========================
         POPUP CRITIQUE VIRUS / INCONNU-SUSPECT
    ============================ -->
    <div id="popupCriticalOverlay" class="overlay">
        <div class="popup popup-critical">
            <div class="popup-header">
                <div class="popup-title popup-title-danger title-font">
                    ALERTE CRITIQUE — VIRUS / MALWARE / INCONNU-SUSPECT
                </div>
            </div>
            <div class="popup-body">
                Le scan a détecté un élément classé comme
                <span class="console-critical">VIRUS / MALWARE</span> ou
                <span class="console-warning">Inconnu mais Suspect</span>.<br><br>
                Cet élément sera supprimé de l'interface dans :
                <span id="criticalCountdown" class="popup-countdown">30</span> secondes.<br><br>
                Conseils de sécurité :
                <ul style="margin-top: 4px; padding-left: 18px;">
                    <li>Ne téléchargez pas de fichiers provenant de sources inconnues.</li>
                    <li>Ne désactivez jamais votre antivirus pour ouvrir un fichier douteux.</li>
                    <li>Évitez de cliquer sur des liens raccourcis ou aléatoires.</li>
                    <li>Gardez votre système et vos logiciels à jour.</li>
                </ul>
            </div>
            <div class="popup-footer">
                <button id="popupCriticalClose" class="btn btn-danger">
                    Fermer (forcer)
                </button>
            </div>
        </div>
    </div>

    <!-- ===========================
         PIED DE PAGE
    ============================ -->
    <div class="footer mono-font">
        <div class="footer-left">
            <span class="footer-strong">8 February 2027's Call — SafeCheck</span>
            <span>|</span>
            <span>Interface de scan antipirate / antimalware (frontend)</span>
        </div>
        <div class="footer-right">
            <div>
                Cette page doit être reliée à un backend spécialisé (antivirus, sandbox) pour un scan RÉEL.
            </div>
            <div>
                FUTURE VAL CORP — Prototype conceptuel.
            </div>
        </div>
    </div>

    <!-- ===========================
         LOGIQUE JS (FRONTEND)
         - Analyse de base (règles fournies)
         - Gestion des popups
         - Simulation des 3 étapes
         - Rappel : le scan réel doit être fait côté serveur
    ============================ -->
    <script>
        // ============================================================
        // UTILITAIRES DE LOG DANS LA CONSOLE
        // ============================================================

        const consoleOutput = document.getElementById('consoleOutput');

        function appendConsoleLine(text, cssClass) {
            const line = document.createElement('div');
            line.classList.add('console-line');
            if (cssClass) {
                line.classList.add(cssClass);
            }
            line.textContent = text;
            consoleOutput.appendChild(line);
            consoleOutput.scrollTop = consoleOutput.scrollHeight;
        }

        function appendConsoleLineWithPrefix(prefix, text, cssClassPrefix, cssClassText) {
            const line = document.createElement('div');
            line.classList.add('console-line');

            const spanPrefix = document.createElement('span');
            spanPrefix.classList.add('console-prefix');
            if (cssClassPrefix) spanPrefix.classList.add(cssClassPrefix);
            spanPrefix.textContent = prefix + ' ';

            const spanText = document.createElement('span');
            if (cssClassText) spanText.classList.add(cssClassText);
            spanText.textContent = text;

            line.appendChild(spanPrefix);
            line.appendChild(spanText);
            consoleOutput.appendChild(line);
            consoleOutput.scrollTop = consoleOutput.scrollHeight;
        }

        // ============================================================
        // RÉFÉRENCES DOM
        // ============================================================

        const textInput = document.getElementById('textInput');
        const fileInput = document.getElementById('fileInput');
        const btnScan = document.getElementById('btnScan');
        const btnClear = document.getElementById('btnClear');
        const btnSimulateBackend = document.getElementById('btnSimulateBackend');

        const popupWarningOverlay = document.getElementById('popupWarningOverlay');
        const popupWarningClose = document.getElementById('popupWarningClose');

        const popupCriticalOverlay = document.getElementById('popupCriticalOverlay');
        const popupCriticalClose = document.getElementById('popupCriticalClose');
        const criticalCountdownSpan = document.getElementById('criticalCountdown');

        let criticalCountdownTimer = null;

        // ============================================================
        // RÈGLES DE CLASSIFICATION (SIMPLIFIÉES)
        //
        // Safe : "https://google.com", "https://testsitefvc.my.canva.site/future-val-corp-fr-siteinvite"
        // Normal : https://facebook.com (tout avec "https://" SAUF caractère plutôt aléatoire)
        // Dangereux : tout ce qui n'a pas "https://" au début.
        // VIRUS/MALWARE : tout ce qui n'a pas "https://" au début + caractère plutôt aléatoire.
        //
        // Fichiers :
        // - Extensions connues : .png, .jpeg, .mp4, .mp3, .m4a, .avi, .txt
        // - Sinon : "Inconnu mais Suspect"
        //
        // Étapes :
        // 1. Scan du texte / fichier (pattern / extension)
        // 2. Scan du fichier/lien (visualisation côté backend — ici simulée)
        // 3. Analyse globale
        //
        // NOTE IMPORTANTE :
        // Ici, tout est simulé côté frontend. Pour un scan réel, il faut :
        // - Envoyer le texte / fichier à un backend sécurisé
        // - Utiliser un antivirus / sandbox côté serveur
        // - Ne jamais exécuter le contenu côté client
        // ============================================================

        function classifyLink(text) {
            if (!text || text.trim().length === 0) {
                return null;
            }

            const trimmed = text.trim();

            // Cas Safe explicites
            if (trimmed === 'https://google.com' ||
                trimmed === 'https://testsitefvc.my.canva.site/future-val-corp-fr-siteinvite') {
                return 'SAFE';
            }

            // Cas Normal : commence par https:// et ne semble pas aléatoire
            if (trimmed.startsWith('https://')) {
                // Heuristique ultra simple : si le lien contient beaucoup de caractères spéciaux / aléatoires
                const randomLike = /[0-9a-zA-Z]{20,}/.test(trimmed);
                if (randomLike) {
                    // On pourrait le classer comme "Inconnu mais Normal" ou "Inconnu mais Suspect"
                    return 'UNKNOWN_NORMAL';
                }
                return 'NORMAL';
            }

            // Pas de https:// au début => Dangereux ou Virus/Malware
            const hasRandomPattern = /[0-9a-zA-Z]{12,}/.test(trimmed);
            if (hasRandomPattern) {
                return 'VIRUS';
            }

            return 'DANGEROUS';
        }

        function classifyFile(file) {
            if (!file) return null;

            const name = file.name || '';
            const lower = name.toLowerCase();

            const knownExtensions = [
                '.png', '.jpeg', '.jpg', '.mp4', '.mp3', '.m4a', '.avi', '.txt'
            ];

            const isKnown = knownExtensions.some(ext => lower.endsWith(ext));

            if (isKnown) {
                // On considère les fichiers connus comme "Inconnu mais Normal" par défaut
                return 'UNKNOWN_NORMAL';
            } else {
                // Extension inconnue => Inconnu mais Suspect
                return 'UNKNOWN_SUSPECT';
            }
        }

        function describeClassification(classification) {
            switch (classification) {
                case 'SAFE':
                    return 'SAFE (Vert)';
                case 'NORMAL':
                    return 'NORMAL (Jaune)';
                case 'DANGEROUS':
                    return 'DANGEREUX (Rouge)';
                case 'VIRUS':
                    return 'VIRUS / MALWARE (Rouge clignotant)';
                case 'UNKNOWN_NORMAL':
                    return 'INCONNU MAIS NORMAL (Orange)';
                case 'UNKNOWN_SUSPECT':
                    return 'INCONNU MAIS SUSPECT (Orange clignotant)';
                default:
                    return 'Aucun / Non défini';
            }
        }

        // ============================================================
        // GESTION DES POPUPS
        // ============================================================

        function showWarningPopup() {
            popupWarningOverlay.classList.add('visible');
        }

        function hideWarningPopup() {
            popupWarningOverlay.classList.remove('visible');
        }

        function showCriticalPopup() {
            popupCriticalOverlay.classList.add('visible');
            startCriticalCountdown();
        }

        function hideCriticalPopup() {
            popupCriticalOverlay.classList.remove('visible');
            stopCriticalCountdown();
        }

        function startCriticalCountdown() {
            let remaining = 30;
            criticalCountdownSpan.textContent = remaining.toString();

            if (criticalCountdownTimer) {
                clearInterval(criticalCountdownTimer);
            }

            criticalCountdownTimer = setInterval(() => {
                remaining -= 1;
                if (remaining <= 0) {
                    clearInterval(criticalCountdownTimer);
                    criticalCountdownTimer = null;
                    criticalCountdownSpan.textContent = '0';

                    // Suppression du lien/fichier à risque dans l'interface
                    textInput.value = '';
                    fileInput.value = '';

                    appendConsoleLineWithPrefix(
                        '[CRITIQUE]',
                        'Lien/fichier à risque supprimé de l’interface après compte à rebours.',
                        'console-critical',
                        'console-critical'
                    );

                    hideCriticalPopup();
                } else {
                    criticalCountdownSpan.textContent = remaining.toString();
                }
            }, 1000);
        }

        function stopCriticalCountdown() {
            if (criticalCountdownTimer) {
                clearInterval(criticalCountdownTimer);
                criticalCountdownTimer = null;
            }
        }

        // ============================================================
        // SIMULATION DES 3 ÉTAPES DE SCAN
        // ============================================================

        function simulateScan() {
            const textValue = textInput.value.trim();
            const file = fileInput.files[0] || null;

            if (!textValue && !file) {
                appendConsoleLineWithPrefix(
                    '[ERREUR]',
                    'Aucune entrée fournie. Ajoutez un lien/texte ou un fichier avant de lancer le scan.',
                    'console-danger',
                    'console-danger'
                );
                return;
            }

            appendConsoleLineWithPrefix(
                '[SCAN]',
                'Démarrage du scan en 3 étapes...',
                null,
                'console-info'
            );

            // Étape 1 : Scan du texte / fichier (pattern / extension)
            setTimeout(() => {
                appendConsoleLineWithPrefix(
                    '[ÉTAPE 1]',
                    'Analyse de la structure du lien/texte et de l’extension du fichier...',
                    null,
                    'console-info'
                );

                const linkClassification = textValue ? classifyLink(textValue) : null;
                const fileClassification = file ? classifyFile(file) : null;

                if (linkClassification) {
                    appendConsoleLineWithPrefix(
                        '[TEXTE]',
                        'Classification initiale : ' + describeClassification(linkClassification),
                        null,
                        linkClassification === 'SAFE' ? 'console-info' :
                        linkClassification === 'NORMAL' ? 'console-warning' :
                        (linkClassification === 'DANGEROUS' ? 'console-danger' :
                        (linkClassification === 'VIRUS' ? 'console-critical' : 'console-warning'))
                    );
                } else {
                    appendConsoleLineWithPrefix(
                        '[TEXTE]',
                        'Aucun texte/lien fourni ou non analysable.',
                        null,
                        'console-muted'
                    );
                }

                if (fileClassification) {
                    appendConsoleLineWithPrefix(
                        '[FICHIER]',
                        'Classification initiale : ' + describeClassification(fileClassification),
                        null,
                        fileClassification === 'UNKNOWN_NORMAL' ? 'console-warning' :
                        (fileClassification === 'UNKNOWN_SUSPECT' ? 'console-danger' : 'console-info')
                    );
                } else {
                    appendConsoleLineWithPrefix(
                        '[FICHIER]',
                        'Aucun fichier fourni.',
                        null,
                        'console-muted'
                    );
                }

                // Étape 2 : Scan du fichier/lien (visualisation côté backend — ici simulée)
                setTimeout(() => {
                    appendConsoleLineWithPrefix(
                        '[ÉTAPE 2]',
                        'Simulation de visualisation sécurisée du lien/fichier (backend requis en production)...',
                        null,
                        'console-info'
                    );

                    appendConsoleLineWithPrefix(
                        '[INFO]',
                        'Dans une version réelle, cette étape enverrait les données à un backend antivirus/sandbox.',
                        null,
                        'console-muted'
                    );

                    // Étape 3 : Analyse globale
                    setTimeout(() => {
                        appendConsoleLineWithPrefix(
                            '[ÉTAPE 3]',
                            'Analyse globale et détermination du niveau de risque...',
                            null,
                            'console-info'
                        );

                        const finalClassification = computeOverallClassification(linkClassification, fileClassification);

                        appendConsoleLineWithPrefix(
                            '[RÉSULTAT]',
                            'Niveau de risque global : ' + describeClassification(finalClassification),
                            null,
                            finalClassification === 'SAFE' ? 'console-info' :
                            finalClassification === 'NORMAL' ? 'console-warning' :
                            (finalClassification === 'DANGEROUS' ? 'console-danger' :
                            (finalClassification === 'VIRUS' ? 'console-critical' :
                            (finalClassification === 'UNKNOWN_NORMAL' ? 'console-warning' : 'console-danger')))
                        );

                        handleClassificationConsequences(finalClassification);

                    }, 600);
                }, 600);
            }, 400);
        }

        function computeOverallClassification(linkClass, fileClass) {
            // Priorité : VIRUS > DANGEREUX > UNKNOWN_SUSPECT > UNKNOWN_NORMAL > NORMAL > SAFE
            const priority = {
                'VIRUS': 6,
                'DANGEROUS': 5,
                'UNKNOWN_SUSPECT': 4,
                'UNKNOWN_NORMAL': 3,
                'NORMAL': 2,
                'SAFE': 1,
                null: 0,
                undefined: 0
            };

            let best = null;

            const candidates = [linkClass, fileClass];
            candidates.forEach(c => {
                if (priority[c] > priority[best]) {
                    best = c;
                }
            });

            return best || null;
        }

        function handleClassificationConsequences(classification) {
            if (!classification) {
                appendConsoleLineWithPrefix(
                    '[INFO]',
                    'Aucune classification globale déterminée.',
                    null,
                    'console-muted'
                );
                return;
            }

            if (classification === 'DANGEROUS' || classification === 'UNKNOWN_NORMAL') {
                appendConsoleLineWithPrefix(
                    '[ALERTE]',
                    'Affichage d’un pop-up d’alerte (Danger / Inconnu-Normal).',
                    null,
                    'console-warning'
                );
                showWarningPopup();
            }

            if (classification === 'VIRUS' || classification === 'UNKNOWN_SUSPECT') {
                appendConsoleLineWithPrefix(
                    '[CRITIQUE]',
                    'Affichage d’un pop-up critique et démarrage du compte à rebours de suppression.',
                    'console-critical',
                    'console-critical'
                );
                showCriticalPopup();
            }

            if (classification === 'SAFE') {
                appendConsoleLineWithPrefix(
                    '[SAFE]',
                    'Le lien/fichier semble sûr selon les règles définies. Rappel : ceci ne remplace pas un antivirus réel.',
                    null,
                    'console-info'
                );
            }

            if (classification === 'NORMAL') {
                appendConsoleLineWithPrefix(
                    '[NORMAL]',
                    'Le lien/fichier semble normal, mais restez vigilant.',
                    null,
                    'console-warning'
                );
            }
        }

        // ============================================================
        // GESTION DES BOUTONS
        // ============================================================

        btnScan.addEventListener('click', () => {
            simulateScan();
        });

        btnClear.addEventListener('click', () => {
            consoleOutput.innerHTML = '';
            appendConsoleLine('[READY] Console effacée. En attente d’entrée utilisateur.', 'console-muted');
        });

        btnSimulateBackend.addEventListener('click', () => {
            appendConsoleLineWithPrefix(
                '[BACKEND]',
                'Pour un scan RÉEL, connecter cette interface à un backend antivirus/sandbox sécurisé.',
                null,
                'console-info'
            );
            appendConsoleLineWithPrefix(
                '[BACKEND]',
                'Exemples : API antivirus, sandbox isolée, analyse heuristique côté serveur.',
                null,
                'console-muted'
            );
        });

        popupWarningClose.addEventListener('click', () => {
            hideWarningPopup();
        });

        popupCriticalClose.addEventListener('click', () => {
            hideCriticalPopup();
            appendConsoleLineWithPrefix(
                '[CRITIQUE]',
                'Pop-up critique fermé manuellement. Le compte à rebours continue si non terminé.',
                'console-critical',
                'console-muted'
            );
        });

        // Fermeture des popups par clic sur l’overlay
        popupWarningOverlay.addEventListener('click', (e) => {
            if (e.target === popupWarningOverlay) {
                hideWarningPopup();
            }
        });

        popupCriticalOverlay.addEventListener('click', (e) => {
            if (e.target === popupCriticalOverlay) {
                hideCriticalPopup();
            }
        });

        // ============================================================
        // MESSAGE INITIAL
        // ============================================================

        appendConsoleLineWithPrefix(
            '[INFO]',
            'SafeCheck est prêt. Entrez un lien/texte ou importez un fichier, puis lancez le scan.',
            null,
            'console-info'
        );
    </script>
</body>
</html>
