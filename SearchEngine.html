<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>8 February 2027's Call - SafeSearch</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="827scall Logo (Carr√©).png">

    <!-- Police Inndam Extended (fallback si non dispo) -->
    <style>
        @font-face {
            font-family: "Inndam Extended";
            src: local("Inndam Extended"), local("Inndam-Extended");
            font-weight: normal;
            font-style: normal;
        }

        :root {
            --bg-color: #05060a;
            --accent: #4fd1ff;
            --accent-soft: rgba(79, 209, 255, 0.18);
            --accent-strong: rgba(79, 209, 255, 0.35);
            --danger: #ff4b6a;
            --warning: #ffb347;
            --safe: #4dff88;
            --text-main: #f5f7ff;
            --text-soft: #a4a8c3;
            --border-soft: rgba(255, 255, 255, 0.08);
            --glass: rgba(10, 12, 20, 0.72);
            --glass-strong: rgba(10, 12, 20, 0.9);
            --shadow-soft: 0 0 40px rgba(0, 0, 0, 0.7);
            --transition-fast: 0.16s ease-out;
            --transition-med: 0.28s ease-out;
            --radius-lg: 22px;
            --radius-md: 14px;
            --radius-sm: 9px;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html, body {
            width: 100%;
            height: 100%;
            background: var(--bg-color);
            color: var(--text-main);
            font-family: monospace;
            overflow: hidden;
        }

        body {
            display: flex;
            align-items: stretch;
            justify-content: center;
        }

        /* --- Layout principal --- */

        .app-root {
            position: relative;
            width: 100%;
            height: 100%;
            overflow: hidden;
            background: #02030a;
        }

        /* Fond d'√©cran personnalis√© */
        .background-layer {
            position: absolute;
            inset: 0;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            filter: brightness(0.9) contrast(1.05);
            transition: opacity 0.6s ease-out, filter 0.6s ease-out;
            opacity: 0;
        }

        .background-layer.visible {
            opacity: 1;
        }

        /* Animation minimaliste sombre (pulsation lente) */
        .fallback-animation {
            position: absolute;
            inset: 0;
            background: radial-gradient(circle at 20% 20%, #15182a 0, #05060a 40%, #000000 100%);
            overflow: hidden;
        }

        .fallback-pulse {
            position: absolute;
            width: 220%;
            height: 220%;
            left: -60%;
            top: -60%;
            background:
                radial-gradient(circle at 30% 20%, rgba(79, 209, 255, 0.08) 0, transparent 45%),
                radial-gradient(circle at 70% 80%, rgba(255, 75, 106, 0.06) 0, transparent 50%),
                radial-gradient(circle at 10% 90%, rgba(77, 255, 136, 0.05) 0, transparent 40%);
            animation: slowPulse 18s ease-in-out infinite alternate;
            opacity: 0.9;
            mix-blend-mode: screen;
        }

        .fallback-grid {
            position: absolute;
            inset: 0;
            background-image:
                linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
            background-size: 40px 40px;
            opacity: 0.25;
            animation: gridDrift 40s linear infinite;
        }

        .fallback-vignette {
            position: absolute;
            inset: 0;
            background:
                radial-gradient(circle at 50% 50%, transparent 0, transparent 40%, rgba(0, 0, 0, 0.7) 100%);
            pointer-events: none;
        }

        @keyframes slowPulse {
            0% {
                transform: scale(1);
                filter: blur(0px);
                opacity: 0.7;
            }
            50% {
                transform: scale(1.05);
                filter: blur(2px);
                opacity: 0.9;
            }
            100% {
                transform: scale(1.1);
                filter: blur(4px);
                opacity: 1;
            }
        }

        @keyframes gridDrift {
            0% {
                transform: translate3d(0, 0, 0);
            }
            100% {
                transform: translate3d(-40px, -40px, 0);
            }
        }

        /* --- Conteneur principal --- */

        .content-layer {
            position: relative;
            z-index: 10;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
            padding: 24px 24px 18px 24px;
        }

        .top-bar {
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 16px;
        }

        .brand-block {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .brand-logo {
            width: 40px;
            height: 40px;
            border-radius: 12px;
            background: radial-gradient(circle at 30% 20%, #ffffff 0, #4fd1ff 40%, #05060a 100%);
            overflow: hidden;
            box-shadow: 0 0 18px rgba(79, 209, 255, 0.5);
        }

        .brand-logo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .brand-text {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .brand-title {
            font-family: "Inndam Extended", system-ui, sans-serif;
            font-size: 16px;
            letter-spacing: 0.16em;
            text-transform: uppercase;
            color: #f7f8ff;
        }

        .brand-subtitle {
            font-size: 11px;
            color: var(--text-soft);
            text-transform: uppercase;
            letter-spacing: 0.18em;
        }

        .top-actions {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .btn-ghost {
            border-radius: 999px;
            border: 1px solid var(--border-soft);
            background: rgba(5, 7, 15, 0.8);
            color: var(--text-soft);
            font-size: 11px;
            padding: 6px 12px;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
            transition: background var(--transition-fast), border-color var(--transition-fast), color var(--transition-fast), transform 0.12s ease-out;
            backdrop-filter: blur(10px);
        }

        .btn-ghost:hover {
            background: rgba(10, 14, 25, 0.95);
            border-color: rgba(255, 255, 255, 0.18);
            color: #ffffff;
            transform: translateY(-1px);
        }

        .btn-ghost span.icon {
            font-size: 13px;
            opacity: 0.9;
        }

        .btn-ghost.danger {
            border-color: rgba(255, 75, 106, 0.4);
            color: #ffb3c2;
        }

        .btn-ghost.danger:hover {
            background: rgba(40, 6, 16, 0.95);
            color: #ffe5ec;
        }

        /* --- Zone centrale --- */

        .center-zone {
            flex: 1;
            width: 100%;
            max-width: 960px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 26px;
        }

        .title-block {
            text-align: center;
            max-width: 720px;
        }

        .main-title {
            font-family: "Inndam Extended", system-ui, sans-serif;
            font-size: clamp(26px, 3vw, 32px);
            letter-spacing: 0.22em;
            text-transform: uppercase;
            color: #f9fbff;
            margin-bottom: 6px;
        }

        .main-subtitle {
            font-size: 12px;
            color: var(--text-soft);
            letter-spacing: 0.16em;
            text-transform: uppercase;
        }

        .search-shell {
            width: 100%;
            max-width: 820px;
            border-radius: 26px;
            padding: 14px;
            background: radial-gradient(circle at 0 0, rgba(79, 209, 255, 0.16), transparent 55%),
                        radial-gradient(circle at 100% 100%, rgba(255, 75, 106, 0.12), transparent 55%),
                        rgba(5, 7, 15, 0.92);
            box-shadow: var(--shadow-soft);
            border: 1px solid rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(18px);
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .search-bar {
            display: flex;
            align-items: center;
            gap: 10px;
            border-radius: 999px;
            padding: 10px 14px;
            background: linear-gradient(135deg, rgba(10, 12, 20, 0.9), rgba(10, 12, 20, 0.96));
            border: 1px solid rgba(255, 255, 255, 0.12);
            box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.6);
            transition: border-color var(--transition-fast), box-shadow var(--transition-fast), background var(--transition-fast);
        }

        .search-bar.focused {
            border-color: rgba(79, 209, 255, 0.8);
            box-shadow:
                0 0 0 1px rgba(79, 209, 255, 0.5),
                0 0 30px rgba(79, 209, 255, 0.4);
            background: linear-gradient(135deg, rgba(10, 12, 20, 0.96), rgba(10, 12, 20, 0.98));
        }

        .search-icon {
            width: 22px;
            height: 22px;
            border-radius: 999px;
            background: radial-gradient(circle at 30% 30%, #ffffff 0, #4fd1ff 40%, #05060a 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #05060a;
            font-size: 12px;
            box-shadow: 0 0 12px rgba(79, 209, 255, 0.7);
        }

        .search-input-wrapper {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .search-input {
            width: 100%;
            border: none;
            outline: none;
            background: transparent;
            color: #f9fbff;
            font-family: monospace;
            font-size: 14px;
        }

        .search-input::placeholder {
            color: rgba(164, 168, 195, 0.7);
        }

        .search-meta {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: 2px;
        }

        .search-hint {
            font-size: 10px;
            color: rgba(164, 168, 195, 0.8);
        }

        .search-hint span.key {
            padding: 1px 6px;
            border-radius: 999px;
            border: 1px solid rgba(164, 168, 195, 0.4);
            font-size: 9px;
            text-transform: uppercase;
            letter-spacing: 0.12em;
        }

        .search-actions {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .risk-pill {
            border-radius: 999px;
            padding: 4px 10px;
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 0.12em;
            border: 1px solid rgba(255, 255, 255, 0.12);
            background: rgba(5, 7, 15, 0.9);
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .risk-dot {
            width: 7px;
            height: 7px;
            border-radius: 999px;
            background: var(--safe);
            box-shadow: 0 0 10px rgba(77, 255, 136, 0.7);
        }

        .risk-pill.safe {
            border-color: rgba(77, 255, 136, 0.6);
            background: rgba(10, 20, 15, 0.9);
        }

        .risk-pill.low {
            border-color: rgba(79, 209, 255, 0.6);
            background: rgba(10, 16, 22, 0.9);
        }

        .risk-pill.moderate {
            border-color: rgba(255, 179, 71, 0.7);
            background: rgba(24, 18, 6, 0.9);
        }

        .risk-pill.high {
            border-color: rgba(255, 75, 106, 0.8);
            background: rgba(32, 8, 14, 0.9);
        }

        .risk-pill.critical {
            border-color: rgba(255, 75, 106, 0.95);
            background: rgba(20, 0, 4, 0.96);
        }

        .risk-pill.low .risk-dot {
            background: var(--accent);
            box-shadow: 0 0 10px rgba(79, 209, 255, 0.7);
        }

        .risk-pill.moderate .risk-dot {
            background: var(--warning);
            box-shadow: 0 0 10px rgba(255, 179, 71, 0.7);
        }

        .risk-pill.high .risk-dot {
            background: var(--danger);
            box-shadow: 0 0 10px rgba(255, 75, 106, 0.7);
        }

        .risk-pill.critical .risk-dot {
            background: #ff0033;
            box-shadow: 0 0 12px rgba(255, 0, 51, 0.9);
        }

        .btn-search {
            border-radius: 999px;
            border: none;
            padding: 7px 16px;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.16em;
            font-family: "Inndam Extended", system-ui, sans-serif;
            cursor: pointer;
            background: linear-gradient(135deg, #4fd1ff, #4dff88);
            color: #05060a;
            box-shadow:
                0 0 16px rgba(79, 209, 255, 0.7),
                0 0 24px rgba(77, 255, 136, 0.5);
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: transform 0.12s ease-out, box-shadow 0.12s ease-out, filter 0.12s ease-out, opacity 0.12s ease-out;
        }

        .btn-search span.icon {
            font-size: 13px;
        }

        .btn-search:hover {
            transform: translateY(-1px);
            filter: brightness(1.05);
            box-shadow:
                0 0 22px rgba(79, 209, 255, 0.9),
                0 0 30px rgba(77, 255, 136, 0.7);
        }

        .btn-search:active {
            transform: translateY(0);
            filter: brightness(0.98);
            box-shadow:
                0 0 10px rgba(79, 209, 255, 0.7),
                0 0 16px rgba(77, 255, 136, 0.5);
        }

        .btn-search.disabled {
            opacity: 0.35;
            cursor: not-allowed;
            box-shadow: none;
            background: linear-gradient(135deg, #555a6a, #333645);
            color: #b0b3c5;
        }

        /* --- R√©sultats de s√©curit√© --- */

        .security-panel {
            margin-top: 6px;
            border-radius: 18px;
            padding: 10px 12px;
            background: rgba(5, 7, 15, 0.9);
            border: 1px solid rgba(255, 255, 255, 0.08);
            display: flex;
            flex-direction: column;
            gap: 6px;
            opacity: 0;
            transform: translateY(6px);
            pointer-events: none;
            transition: opacity var(--transition-med), transform var(--transition-med);
        }

        .security-panel.visible {
            opacity: 1;
            transform: translateY(0);
            pointer-events: auto;
        }

        .security-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 8px;
        }

        .security-title {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.16em;
            color: var(--text-soft);
        }

        .security-tag {
            font-size: 10px;
            padding: 3px 8px;
            border-radius: 999px;
            border: 1px solid rgba(255, 255, 255, 0.12);
            text-transform: uppercase;
            letter-spacing: 0.14em;
        }

        .security-body {
            font-size: 11px;
            color: rgba(220, 224, 245, 0.9);
            line-height: 1.5;
        }

        .security-body span.keyword {
            color: #ffffff;
            font-weight: bold;
        }

        .security-body span.level {
            font-weight: bold;
        }

        .security-body span.level.safe {
            color: var(--safe);
        }

        .security-body span.level.low {
            color: var(--accent);
        }

        .security-body span.level.moderate {
            color: var(--warning);
        }

        .security-body span.level.high {
            color: var(--danger);
        }

        .security-body span.level.critical {
            color: #ff0033;
        }

        .security-footer {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: 4px;
        }

        .security-note {
            font-size: 10px;
            color: rgba(164, 168, 195, 0.85);
        }

        .security-note strong {
            color: #ffffff;
        }

        .security-badge {
            font-size: 10px;
            padding: 3px 8px;
            border-radius: 999px;
            border: 1px solid rgba(255, 255, 255, 0.16);
            text-transform: uppercase;
            letter-spacing: 0.14em;
        }

        /* --- Historique --- */

        .history-panel {
            width: 100%;
            max-width: 820px;
            margin-top: 10px;
            border-radius: 18px;
            padding: 10px 12px;
            background: rgba(5, 7, 15, 0.9);
            border: 1px solid rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(14px);
            display: flex;
            flex-direction: column;
            gap: 8px;
            max-height: 160px;
            overflow: hidden;
        }

        .history-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .history-title {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.16em;
            color: var(--text-soft);
        }

        .history-actions {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .history-list {
            margin-top: 4px;
            overflow-y: auto;
            padding-right: 4px;
        }

        .history-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 8px;
            padding: 4px 6px;
            border-radius: 10px;
            transition: background var(--transition-fast), transform 0.08s ease-out;
            cursor: pointer;
        }

        .history-item:hover {
            background: rgba(255, 255, 255, 0.04);
            transform: translateY(-1px);
        }

        .history-left {
            display: flex;
            align-items: center;
            gap: 8px;
            min-width: 0;
        }

        .history-dot {
            width: 7px;
            height: 7px;
            border-radius: 999px;
            background: rgba(164, 168, 195, 0.7);
        }

        .history-text {
            font-size: 11px;
            color: rgba(220, 224, 245, 0.9);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .history-meta {
            font-size: 9px;
            color: rgba(164, 168, 195, 0.8);
        }

        .history-remove {
            font-size: 11px;
            color: rgba(255, 255, 255, 0.5);
            cursor: pointer;
            padding: 2px 4px;
            border-radius: 6px;
            transition: background var(--transition-fast), color var(--transition-fast);
        }

        .history-remove:hover {
            background: rgba(255, 75, 106, 0.16);
            color: #ffe5ec;
        }

        /* --- Bas de page --- */

        .bottom-bar {
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
            font-size: 10px;
            color: var(--text-soft);
        }

        .bottom-left {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .bottom-right {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .badge {
            padding: 3px 8px;
            border-radius: 999px;
            border: 1px solid rgba(255, 255, 255, 0.12);
            text-transform: uppercase;
            letter-spacing: 0.16em;
        }

        .badge.safe {
            border-color: rgba(77, 255, 136, 0.7);
            color: #c9ffe0;
        }

        .badge.rgpd {
            border-color: rgba(79, 209, 255, 0.7);
            color: #d9f3ff;
        }

        .bottom-link {
            text-decoration: none;
            color: var(--text-soft);
            border-bottom: 1px dashed rgba(164, 168, 195, 0.5);
            padding-bottom: 1px;
        }

        .bottom-link:hover {
            color: #ffffff;
            border-bottom-style: solid;
        }

        /* --- Pop-up de s√©curit√© --- */

        .overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 50;
        }

        .overlay.visible {
            display: flex;
        }

        .dialog {
            width: 100%;
            max-width: 420px;
            border-radius: 20px;
            background: var(--glass-strong);
            border: 1px solid rgba(255, 255, 255, 0.16);
            box-shadow: 0 0 40px rgba(0, 0, 0, 0.9);
            padding: 18px 18px 14px 18px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            animation: dialogIn 0.18s ease-out;
        }

        @keyframes dialogIn {
            from {
                opacity: 0;
                transform: translateY(10px) scale(0.98);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .dialog-header {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .dialog-icon {
            width: 26px;
            height: 26px;
            border-radius: 999px;
            background: radial-gradient(circle at 30% 30%, #ffffff 0, #ff4b6a 40%, #05060a 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #05060a;
            font-size: 14px;
            box-shadow: 0 0 16px rgba(255, 75, 106, 0.8);
        }

        .dialog-title {
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 0.16em;
            color: #ffe5ec;
        }

        .dialog-body {
            font-size: 11px;
            color: rgba(230, 232, 248, 0.95);
            line-height: 1.6;
        }

        .dialog-body span.keyword {
            font-weight: bold;
            color: #ffffff;
        }

        .dialog-body span.level {
            font-weight: bold;
            color: var(--danger);
        }

        .dialog-footer {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            gap: 8px;
            margin-top: 4px;
        }

        .btn-dialog {
            border-radius: 999px;
            border: 1px solid rgba(255, 255, 255, 0.18);
            padding: 6px 12px;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.14em;
            background: rgba(10, 12, 20, 0.96);
            color: #f5f7ff;
            cursor: pointer;
            transition: background var(--transition-fast), border-color var(--transition-fast), color var(--transition-fast), transform 0.08s ease-out;
        }

        .btn-dialog:hover {
            background: rgba(18, 20, 30, 0.98);
            border-color: rgba(255, 255, 255, 0.3);
            transform: translateY(-1px);
        }

        .btn-dialog.primary {
            background: linear-gradient(135deg, #4fd1ff, #ff4b6a);
            border-color: rgba(255, 255, 255, 0.4);
            color: #05060a;
            box-shadow:
                0 0 16px rgba(79, 209, 255, 0.7),
                0 0 20px rgba(255, 75, 106, 0.7);
        }

        .btn-dialog.primary:hover {
            filter: brightness(1.05);
        }

        /* --- Input fichier cach√© --- */

        #bg-file-input {
            display: none;
        }

        /* --- Scrollbar custom --- */

        .history-list::-webkit-scrollbar {
            width: 6px;
        }

        .history-list::-webkit-scrollbar-track {
            background: transparent;
        }

        .history-list::-webkit-scrollbar-thumb {
            background: rgba(164, 168, 195, 0.4);
            border-radius: 999px;
        }

        .history-list::-webkit-scrollbar-thumb:hover {
            background: rgba(164, 168, 195, 0.7);
        }

        /* --- Responsive --- */

        @media (max-width: 768px) {
            .content-layer {
                padding: 16px 14px 12px 14px;
            }

            .search-shell {
                padding: 10px;
            }

            .search-bar {
                padding: 8px 10px;
            }

            .top-bar {
                flex-direction: column;
                align-items: flex-start;
            }

            .bottom-bar {
                flex-direction: column;
                align-items: flex-start;
            }

            .center-zone {
                justify-content: center;
            }
        }

        @media (max-width: 480px) {
            .brand-title {
                font-size: 13px;
            }

            .brand-subtitle {
                font-size: 9px;
            }

            .main-title {
                font-size: 20px;
            }

            .main-subtitle {
                font-size: 10px;
            }

            .btn-search {
                padding: 6px 12px;
                font-size: 10px;
            }

            .history-panel {
                max-height: 130px;
            }
        }
    </style>
</head>
<body>
<div class="app-root">
    <!-- Fond personnalis√© -->
    <div class="background-layer" id="background-layer"></div>

    <!-- Animation fallback -->
    <div class="fallback-animation" id="fallback-animation">
        <div class="fallback-pulse"></div>
        <div class="fallback-grid"></div>
        <div class="fallback-vignette"></div>
    </div>

    <!-- Contenu principal -->
    <div class="content-layer">
        <!-- Barre du haut -->
        <div class="top-bar">
            <div class="brand-block">
                <div class="brand-logo">
                    <!-- Si l'image existe, elle sera visible -->
                    <img src="827scall Logo (Carr√©).png" alt="827's Call Logo" onerror="this.style.display='none'">
                </div>
                <div class="brand-text">
                    <div class="brand-title">8 February 2027's Call</div>
                    <div class="brand-subtitle">SafeSearch ‚Ä¢ Security-Aware Gateway</div>
                </div>
            </div>
            <div class="top-actions">
                <button class="btn-ghost" id="btn-bg-upload">
                    <span class="icon">üñºÔ∏è</span>
                    <span>Fond d'√©cran perso</span>
                </button>
                <button class="btn-ghost danger" id="btn-bg-reset">
                    <span class="icon">‚úñ</span>
                    <span>R√©initialiser le fond</span>
                </button>
            </div>
        </div>

        <!-- Zone centrale -->
        <div class="center-zone">
            <div class="title-block">
                <div class="main-title">INTELLIGENT SECURITY SEARCH</div>
                <div class="main-subtitle">Analyse des risques ‚Ä¢ Passage vers Google ‚Ä¢ 8 February 2027's Call</div>
            </div>

            <div class="search-shell">
                <div class="search-bar" id="search-bar">
                    <div class="search-icon">‚óé</div>
                    <div class="search-input-wrapper">
                        <input
                            type="text"
                            id="search-input"
                            class="search-input"
                            placeholder="Tape ta recherche ici‚Ä¶ (le portail analysera les risques avant de te laisser passer vers Google)"
                            autocomplete="off"
                        >
                        <div class="search-meta">
                            <div class="search-hint">
                                <span class="key">Entr√©e</span> pour lancer la recherche ‚Ä¢ Analyse automatique apr√®s 0.16s
                            </div>
                            <div class="search-actions">
                                <div class="risk-pill safe" id="risk-pill">
                                    <div class="risk-dot"></div>
                                    <span id="risk-label">V√©rifi√© (Safe)</span>
                                </div>
                                <button class="btn-search" id="btn-search">
                                    <span class="icon">‚Üó</span>
                                    <span>Rechercher</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="security-panel" id="security-panel">
                    <div class="security-header">
                        <div class="security-title">Analyse de s√©curit√© de la requ√™te</div>
                        <div class="security-tag" id="security-tag">Analyse en temps r√©el</div>
                    </div>
                    <div class="security-body" id="security-body">
                        Tape une requ√™te pour voir son niveau de risque.
                    </div>
                    <div class="security-footer">
                        <div class="security-note">
                            <strong>Note :</strong> ce portail ne bloque pas Internet, il t'informe avant de t'envoyer vers Google.
                        </div>
                        <div class="security-badge">8F27 ‚Ä¢ Security Layer</div>
                    </div>
                </div>
            </div>

            <div class="history-panel">
                <div class="history-header">
                    <div class="history-title">Historique des recherches</div>
                    <div class="history-actions">
                        <button class="btn-ghost" id="btn-history-clear" style="padding:3px 8px;font-size:9px;">
                            Effacer tout
                        </button>
                    </div>
                </div>
                <div class="history-list" id="history-list">
                    <!-- Items dynamiques -->
                </div>
            </div>
        </div>

        <!-- Bas de page -->
        <div class="bottom-bar">
            <div class="bottom-left">
                <div class="badge safe">Security-Aware Gateway</div>
                <div class="badge rgpd">RGPD ‚Ä¢ CNIL ‚Ä¢ Respect de la vie priv√©e</div>
            </div>
            <div class="bottom-right">
                <span>Navigation finale via Google ‚Ä¢ Requ√™tes non stock√©es c√¥t√© serveur</span>
            </div>
        </div>
    </div>

    <!-- Pop-up de s√©curit√© -->
    <div class="overlay" id="security-overlay">
        <div class="dialog">
            <div class="dialog-header">
                <div class="dialog-icon">!</div>
                <div class="dialog-title">Alerte de s√©curit√© ‚Ä¢ Risque √âlev√©</div>
            </div>
            <div class="dialog-body" id="dialog-body">
                Tu t'appr√™tes √† lancer une recherche consid√©r√©e comme <span class="level">√âlev√©e</span>.
                <br><br>
                Requ√™te : <span class="keyword" id="dialog-keyword"></span>
                <br><br>
                Ce type de recherche peut t'exposer √† des sites frauduleux, des t√©l√©chargements dangereux ou des contenus trompeurs.
                <br>
                Veux-tu vraiment continuer vers Google avec cette requ√™te ?
            </div>
            <div class="dialog-footer">
                <button class="btn-dialog" id="dialog-cancel">Annuler</button>
                <button class="btn-dialog primary" id="dialog-confirm">Continuer</button>
            </div>
        </div>
    </div>

    <!-- Input fichier pour fond d'√©cran -->
    <input type="file" id="bg-file-input" accept="image/*">
</div>

<script>
/* ============================================================
   8 February 2027's Call ‚Ä¢ Intelligent Security Search
   Fichier unique : HTML + CSS + JS
   - Analyse de risque
   - Historique local
   - Fond d'√©cran personnalis√©
   - Redirection vers Google
   ============================================================ */

/* ------------------------------------------------------------
   1. S√©lecteurs principaux
   ------------------------------------------------------------ */

const searchInput = document.getElementById('search-input');
const searchBar = document.getElementById('search-bar');
const btnSearch = document.getElementById('btn-search');
const riskPill = document.getElementById('risk-pill');
const riskLabel = document.getElementById('risk-label');
const securityPanel = document.getElementById('security-panel');
const securityBody = document.getElementById('security-body');
const securityTag = document.getElementById('security-tag');
const historyList = document.getElementById('history-list');
const btnHistoryClear = document.getElementById('btn-history-clear');
const bgLayer = document.getElementById('background-layer');
const fallbackAnimation = document.getElementById('fallback-animation');
const btnBgUpload = document.getElementById('btn-bg-upload');
const btnBgReset = document.getElementById('btn-bg-reset');
const bgFileInput = document.getElementById('bg-file-input');
const overlay = document.getElementById('security-overlay');
const dialogKeyword = document.getElementById('dialog-keyword');
const dialogCancel = document.getElementById('dialog-cancel');
const dialogConfirm = document.getElementById('dialog-confirm');

/* ------------------------------------------------------------
   2. Gestion du focus / style
   ------------------------------------------------------------ */

searchInput.addEventListener('focus', () => {
    searchBar.classList.add('focused');
});

searchInput.addEventListener('blur', () => {
    searchBar.classList.remove('focused');
});

/* ------------------------------------------------------------
   3. Syst√®me d'analyse de risque
   ------------------------------------------------------------ */

/*
   Niveaux :
   - "verified"  -> V√©rifi√© (Safe)
   - "low"       -> Faible
   - "moderate"  -> Mod√©r√©
   - "high"      -> √âlev√©
   - "critical"  -> √† RISQUE
*/

/* --- Listes de mots / expressions par niveau --- */
/* Tu m'as demand√© de tout mettre en dur, donc voici les blocs massifs. */

/* V√©rifi√© (Safe) */
const VERIFIED_TERMS = [
    "microsoft","copilot","windows","azure","github","visual studio",
    "hatsune miku","vocaloid","crypton future media",
    "future val corp","fvc val","valentin burel","8 f√©vrier 2027","8 fevrier 2027",
    "nintendo","playstation","xbox","steam","epic games",
    "youtube","wikipedia","google maps","gmail","outlook",
    "france","normandie","le havre","paris","lyon","marseille",
    "√©cologie","ecologie","technologie","innovation","science","astronomie",
    "python","java","html","css","javascript",
    "roblox","unity","unreal engine",
    "musique","art","po√©sie","poesie","cin√©ma","cinema","th√©√¢tre","theatre",
    "√©ducation","education","histoire","g√©ographie","geographie","math√©matiques","mathematiques",
    "s√©curit√©","securite","rgpd","cnil","confidentialit√©","confidentialite",
    "climat","oc√©an","ocean","for√™t","foret","biodiversit√©","biodiversite",
    "transport","train","tramway","v√©lo","velo","bus",
    "sant√© publique","sante publique","nutrition","sport","yoga",
    "photographie","design","architecture","sculpture",
    "√©nergie solaire","energie solaire","√©nergie √©olienne","energie eolienne","hydrog√®ne","hydrogene",
    "√©conomie","economie","finance","entreprise","startup",
    "philosophie","psychologie","sociologie",
    "langues","fran√ßais","francais","anglais","japonais","espagnol",
    "cuisine","recette","p√¢tisserie","patisserie","chocolat",
    "jeux vid√©o","jeux video","manga","anime","figurines",
    "ordinateur","clavier","souris","√©cran","ecran",
    "s√©curit√© informatique","securite informatique","firewall","antivirus",
    "plan√®te","planete","univers","galaxie","√©toile","etoile",
    "oc√©an","ocean","rivi√®re","riviere","montagne","for√™t","foret",
    "innovation durable","technologie verte","√©co‚Äëdesign","eco-design","eco design",
    "cr√©ativit√©","creativite","narration","mythologie","symbolisme"
];

/* Faible */
const LOW_TERMS = [
    "paris","m√©t√©o","meteo","recette","voiture","maison","musique","film","actualit√©","actualite",
    "sport","sant√©","sante","√©cole","ecole","travail","ordinateur","t√©l√©phone","telephone","carte",
    "voyage","h√¥tel","hotel","restaurant","caf√©","cafe","jardin","animal","fleur","montagne","mer",
    "plage","for√™t","foret","livre","science","histoire","culture","art","peinture","photo",
    "m√©t√©o demain","meteo demain","traduction","dictionnaire","m√©t√©o france","meteo france",
    "m√©t√©o paris","meteo paris","m√©t√©o lyon","meteo lyon","m√©t√©o marseille","meteo marseille",
    "m√©t√©o toulouse","meteo toulouse","m√©t√©o nice","meteo nice","m√©t√©o nantes","meteo nantes",
    "m√©t√©o lille","meteo lille","m√©t√©o bordeaux","meteo bordeaux","m√©t√©o rennes","meteo rennes",
    "m√©t√©o strasbourg","meteo strasbourg","m√©t√©o montpellier","meteo montpellier","m√©t√©o belgique",
    "meteo belgique","m√©t√©o suisse","meteo suisse","m√©t√©o canada","meteo canada",
    "weather","news","music","movie","travel","hotel","restaurant","food","recipe","computer","phone",
    "map","school","university","internet","website","tutorial","guide","how to","learn","study","work",
    "job","office","design","color","image","picture","video","playlist","song","lyrics","calendar",
    "time","date","clock","weather forecast","news today","news world","news local",
    "shopping","store","market","city","country","world","nature","book","technology",
    "wifi","bluetooth","charger","usb","keyboard","mouse","screen","monitor","laptop","tablet",
    "smartphone","camera","photo editor","notes","reminder","alarm","train","bus","taxi","airport",
    "flight","ticket","booking","reservation","museum","park","zoo","library","festival","event",
    "concert","podcast","radio","bookshop","supermarket","bakery","fruit","vegetable","water","coffee",
    "tea","chocolate","bread","pasta","rice","chicken","fish","vegan","vegetarian","dessert","cake",
    "cookie","soup","salad","sandwich","breakfast","lunch","dinner","holiday","weekend","summer",
    "winter","spring","autumn","sunrise","sunset","cloud","rain","snow","wind","temperature",
    "map world","map europe","map asia","map africa","map america","map oceania","currency","euro",
    "dollar","peso","yen","yuan","rupee","rouble","language","grammar","vocabulary","synonym","antonym",
    "translation english","translation french","translation spanish","translation chinese",
    "translation arabic","translation hindi","translation japanese","translation russian",
    "translation filipino","travel tips","cooking tips","study tips","work tips","productivity",
    "creativity","design ideas","color palette","minimalism","architecture","interior design","fashion",
    "clothes","shoes","accessories","hairstyle","makeup","skincare","fitness","yoga","meditation",
    "running","walking","cycling","swimming","gym","training","exercise","health tips","vitamins",
    "minerals","nature facts","animal facts","space","planet","moon","sun","stars","galaxy","universe",
    "science facts","history facts","culture facts","art styles","music genres","movie genres",
    "book genres","famous cities","famous countries","famous monuments","famous museums",
    "famous artists","famous writers","famous scientists","famous musicians","famous actors",
    "famous directors","famous landmarks","famous mountains","famous rivers","famous lakes",
    "famous islands","famous foods","famous recipes","famous festivals","famous traditions"
    // + toutes les variantes multilingues que tu as list√©es (ici on simplifie un peu pour garder le fichier lisible)
];

/* Mod√©r√© */
const MODERATE_TERMS = [
    "gratuit","cadeau","gagner","loterie","tirage","bonus","crypto","investissement rapide",
    "support technique","d√©bloquer compte","debloquer compte","v√©rification urgente","verification urgente",
    "remboursement imm√©diat","remboursement immediat","offre limit√©e","offre limitee","promotion sp√©ciale",
    "promotion speciale","coupon","code promo","num√©ro surtax√©","numero surtaxe","service client faux",
    "assistance en ligne","d√©bloquer t√©l√©phone","debloquer telephone","mot de passe oubli√©",
    "mot de passe oublie","compte bloqu√©","compte bloque","paiement s√©curis√©","paiement securise",
    "livraison gratuite","suivi colis","num√©ro inconnu","numero inconnu","message suspect","email √©trange",
    "email etrange","t√©l√©chargement gratuit","telechargement gratuit","torrent","crack logiciel","apk",
    "version modifi√©e","version modifiee","activation gratuite","cl√© d‚Äôactivation","cle d‚Äôactivation",
    "licence gratuite","antivirus gratuit","scan gratuit","nettoyage pc","optimisation syst√®me",
    "optimisation systeme","booster t√©l√©phone","booster telephone","r√©paration en ligne","reparation en ligne",
    "pr√™t rapide","pret rapide","cr√©dit facile","credit facile","argent imm√©diat","argent immediat",
    "job √† domicile","job a domicile","travail facile","gains rapides","trading automatique","robot trading",
    "forex facile","doublement argent","cashback","r√©duction √©norme","reduction enorme","prix bas",
    "contrefa√ßon","contrefacon","imitation","copie","r√©plique","replique","marque discount","outlet",
    "liquidation totale","crypto mining","cloud mining","wallet gratuit","airdrop","nft gratuit",
    "token gratuit","√©change crypto","echange crypto","support wallet","phishing","fausse banque",
    "fausse facture","fausse livraison","fausse amende","fausse police","fausse s√©curit√©","fausse securite",
    "fausse mise √† jour","fausse mise a jour","fausse application","fausse boutique","fausse loterie",
    "fausse donation","fausse charit√©","fausse charite","fausse bourse","fausse assurance","fausse agence",
    "fausse r√©servation","fausse reservation","fausse location","fausse annonce","fausse r√©duction",
    "fausse reduction","fausse opportunit√©","fausse opportunite","fake support","fake giveaway",
    "fake prize","free money","win now","claim reward","urgent message","verify account","unlock account",
    "free download","free software","crack download","mod apk","hacked version","free license",
    "free antivirus","pc cleaner","phone booster","easy loan","fast loan","instant cash","work from home",
    "easy job","online job","crypto bonus","free crypto","mining free","wallet support","scam alert",
    "suspicious link","unknown number","strange sms","phishing email","fake invoice","fake delivery",
    "fake police","fake security","fake update","fake app","fake store","fake charity","fake investment",
    "fake opportunity"
    // + variantes multilingues (simplifi√©es ici)
];

/* √âlev√© */
const HIGH_TERMS = [
    "virus","malware","spyware","ransomware","trojan","cheval de troie","keylogger","botnet","rootkit",
    "exploit","injection","phishing site","phishing login","fake login","fake update","fausse mise √† jour",
    "fausse mise a jour","fausse application","fausse s√©curit√©","fausse securite","fausse authentification",
    "fausse banque","fausse facture","fausse livraison","fausse identit√©","fausse identite",
    "fausse v√©rification","fausse verification","fausse connexion","fausse assistance","fausse hotline",
    "fausse r√©cup√©ration","fausse recuperation","fausse activation","fausse licence","fausse cl√©","fausse cle",
    "fausse boutique","fausse plateforme","fausse crypto","fausse bourse","fausse agence","fausse r√©servation",
    "fausse reservation","fausse location","fausse donation","fausse charit√©","fausse charite",
    "fausse r√©duction","fausse reduction","fausse opportunit√©","fausse opportunite","t√©l√©chargement risqu√©",
    "telechargement risque","t√©l√©chargement inconnu","telechargement inconnu","fichier suspect",
    "fichier dangereux","fichier non v√©rifi√©","fichier non verifie","fichier non sign√©","fichier non signe",
    "fichier infect√©","fichier infecte","fichier corrompu","fichier modifi√©","fichier modifie",
    "fichier pirat√©","fichier pirate","crack download","crack software","crack tool","mod apk",
    "apk non officiel","apk modifi√©","apk modifie","apk dangereux","apk inconnu","apk pirat√©","apk pirate",
    "apk injection","apk premium free","apk unlimited","hack tool","cheat tool","generator online",
    "unlimited coins","unlimited gems","premium hack","premium unlock","unlock tool","bypass tool",
    "bypass login","bypass security","bypass verification","bypass account","bypass phone","bypass icloud",
    "bypass sim","imei unlock","imei changer","imei tool","firmware modifi√©","firmware modifie",
    "firmware dangereux","firmware non officiel","rom custom","rom modifi√©e","rom modifiee","rom pirat√©e",
    "rom pirate","rom injection","iso inconnu","iso modifi√©","iso modifie","iso dangereux","torrent risqu√©",
    "torrent risque","torrent inconnu","torrent crack","torrent iso","torrent premium","torrent software",
    "torrent hack","streaming risqu√©","streaming risque","streaming inconnu","streaming non s√©curis√©",
    "streaming non securise","streaming apk","streaming mod","iptv hack","iptv code","iptv m3u",
    "iptv playlist","iptv premium free","iptv non officiel","iptv injection","iptv cracked",
    "site non s√©curis√©","site non securise","site dangereux","site frauduleux","site inconnu",
    "site non v√©rifi√©","site non verifie","site non officiel","site miroir","site clone","site pirat√©",
    "site pirate","site compromis","domaine suspect","domaine frauduleux","domaine non s√©curis√©",
    "domaine non securise","domaine inconnu","domaine non v√©rifi√©","domaine non verifie","lien suspect",
    "lien dangereux","lien inconnu","lien non s√©curis√©","lien non securise","lien non v√©rifi√©",
    "lien non verifie","lien court suspect","redirection suspecte","redirection dangereuse","pop-up s√©curit√©",
    "popup s√©curit√©","popup securite","certificat invalide","certificat expir√©","certificat expire",
    "certificat non fiable","connexion non s√©curis√©e","connexion non securisee","http non s√©curis√©",
    "http non securise","ssl error","tls error","security alert","suspicious activity","suspicious login",
    "suspicious download","suspicious file","suspicious link","suspicious domain","suspicious message",
    "suspicious sms","suspicious email","unknown sender","unknown file","unknown app","unknown apk",
    "unknown extension","exe dangereux","exe inconnu","exe modifi√©","exe modifie","exe pirat√©","exe pirate",
    "exe injection","zip dangereux","zip inconnu","zip infect√©","zip infecte","rar dangereux","rar inconnu",
    "rar infect√©","rar infecte","script inconnu","script dangereux","script injection","powershell suspect",
    "batch suspect","macro dangereuse","macro inconnue","macro injection","keygen","serial generator",
    "license generator","activation tool","activation crack","patch tool","patch crack","unlock premium",
    "premium free","free full version","full version crack","software crack","driver non officiel",
    "driver modifi√©","driver modifie","driver dangereux","driver pirat√©","driver pirate",
    "extension navigateur suspecte","plugin suspect","plugin dangereux","plugin non officiel","plugin injection",
    "navigateur compromis","navigateur pirat√©","compte compromis","compte suspect","activit√© suspecte",
    "acces non autoris√©","acces non autorise","tentative connexion","tentative intrusion","brute force",
    "credential stuffing","leak password","leak data","data breach","database leak","dump leak","cloud leak",
    "backup leak","recovery tool suspect","recovery hack","phone hack","pc hack","remote access tool",
    "remote control tool","remote injection","remote exploit","remote session unknown","remote desktop unknown",
    "remote apk","remote script"
];

/* √† RISQUE */
const CRITICAL_TERMS = [
    "dark web","deep web","hidden service","onion link","tor browser","tor hidden","darknet market",
    "black market","march√© noir","marche noir","site adulte","contenu adulte","site 18+","site 18 plus",
    "acc√®s restreint","acces restreint","contenu restreint","safe search off","filtre d√©sactiv√©",
    "filtre desactive","site non index√©","site non indexe","forum cach√©","forum cache","private forum",
    "underground forum","leak forum","database leak","full dump","full database","combo list",
    "password list","credential dump","cracked accounts","account dump","premium accounts","stolen accounts",
    "stolen data","identity dump","identity sale","fake identity","fausse identit√©","fausse identite",
    "faux papiers","faux documents","faux passeport","faux permis","faux justificatif","faux compte",
    "fausse carte","fausse carte bancaire","fausse carte identit√©","fausse carte identite",
    "fausse carte cr√©dit","fausse carte credit","fausse carte d√©bit","fausse carte debit","fausse facture",
    "fausse fiche de paie","fausse attestation","fausse preuve","g√©n√©rateur de documents",
    "generateur de documents","document generator","fake document","fake id","fake card","fake profile",
    "fake account","bypass age","age verification bypass","parental control bypass","safe search bypass",
    "filter bypass","region lock bypass","geo restriction bypass","streaming lock bypass","paywall bypass",
    "premium bypass","licence bypass","drm bypass","drm removal","protection removal","crack key",
    "serial crack","keygen advanced","advanced hacking","exploit kit","zero day","0day exploit",
    "remote exploit","privilege escalation","root access","root android","jailbreak ios","jailbreak tool",
    "bootloader unlock","bootloader exploit","firmware exploit","bios exploit","uefi exploit",
    "cheat engine advanced","memory editor","packet editor","network sniffer ill√©gal",
    "network sniffer illegal","traffic interceptor","man in the middle","mitm tool","credential stealer",
    "token stealer","session hijack","cookie stealer","browser stealer","stealer log","stealer config",
    "malware builder","trojan builder","ransomware builder","botnet builder","crypter","fud crypter",
    "stub crypter","obfuscator ill√©gal","obfuscator illegal","code injector","dll injector",
    "process hollowing","process injection","remote shell","reverse shell","c2 server","command and control",
    "rat tool","remote admin tool ill√©gal","remote admin tool illegal","keylogger avanc√©",
    "keylogger avance","undetectable keylogger","undetected malware","fud malware","fud keylogger",
    "fud rat","fud stealer","antivirus bypass","edr bypass","defender bypass","sandbox bypass","vm detection",
    "anti debug","anti analysis","phishing kit","phishing template","phishing page","clone page","login clone",
    "bank clone","paypal clone","crypto exchange clone","fausse passerelle paiement",
    "fake payment gateway","fake checkout","fake shop","fake marketplace","scam kit","scam script",
    "scam template","carding","carding forum","carding tutorial","carding shop","cvv shop","cvv dump","fullz",
    "bank drop","money mule","cashout method","cashout tutorial","fraud method","m√©thode fraude",
    "methode fraude","m√©thode arnaque avanc√©e","methode arnaque avancee","spam bot","sms bomber",
    "mail bomber","call bomber","ddos tool","ddos panel","booter","stresser","ip stresser","layer7 attack",
    "flood attack","botnet attack","brute force panel","credential stuffing tool","combo checker",
    "account checker","netflix checker","spotify checker","steam checker","game checker","vpn checker",
    "proxy checker","proxy list","socks5 list","elite proxy","anonymous proxy","residential proxy","rdp list",
    "hacked rdp","hacked cpanel","hacked ssh","hacked server","shell access","webshell","c99 shell",
    "r57 shell","php shell","backdoor php","backdoor web","index deface","site deface","defacement",
    "hack group","hack team","leak channel","private channel leak","premium leak","only premium leak",
    "contenu premium leak","abonnement leak","paywall leak","fichier sensible","document sensible",
    "data sensitive","medical data leak","corporate leak","internal leak","confidential leak",
    "espionnage num√©rique","espionnage numerique","surveillance ill√©gale","surveillance illegale",
    "stalkerware","spy app","spy phone","spy tool","hidden tracker","hidden camera app","remote mic",
    "remote camera","sms spy","whatsapp spy","messenger spy","social media spy","account spy",
    "location tracker ill√©gal","location tracker illegal","gps tracker ill√©gal","gps tracker illegal",
    "suivi discret","suivi cach√©","suivi cache","bypass 2fa","2fa bypass","otp bypass","sms intercept",
    "call intercept","sim swap","sim swap method","sim cloning","sim clone","imei changer avanc√©",
    "imei changer avance","baseband exploit","network exploit","wifi hack","wifi crack","wpa2 crack",
    "wpa3 crack","handshake crack","evil twin","rogue ap","captive portal fake","hotspot fake",
    "captive portal phishing","dns spoof","arp spoof","ssl strip"
];

/* ------------------------------------------------------------
   4. Fuzzy matching simple
   ------------------------------------------------------------ */

function normalizeText(text) {
    return text
        .toLowerCase()
        .normalize("NFD")
        .replace(/[\u0300-\u036f]/g, "")
        .replace(/[^a-z0-9+@#\.\-\s]/g, " ")
        .replace(/\s+/g, " ")
        .trim();
}

function containsAnyTerm(query, terms) {
    const q = normalizeText(query);
    for (const term of terms) {
        const t = normalizeText(term);
        if (!t) continue;
        if (q.includes(t)) return true;
    }
    return false;
}

/* ------------------------------------------------------------
   5. D√©termination du niveau de risque
   ------------------------------------------------------------ */

function getRiskLevel(query) {
    const q = normalizeText(query);
    if (!q) return { level: "none", label: "Aucune requ√™te", score: 0 };

    // Ordre : CRITICAL > HIGH > MODERATE > LOW > VERIFIED
    if (containsAnyTerm(q, CRITICAL_TERMS)) {
        return { level: "critical", label: "√† RISQUE", score: 4 };
    }
    if (containsAnyTerm(q, HIGH_TERMS)) {
        return { level: "high", label: "√âlev√©", score: 3 };
    }
    if (containsAnyTerm(q, MODERATE_TERMS)) {
        return { level: "moderate", label: "Mod√©r√©", score: 2 };
    }
    if (containsAnyTerm(q, LOW_TERMS)) {
        return { level: "low", label: "Faible", score: 1 };
    }
    if (containsAnyTerm(q, VERIFIED_TERMS)) {
        return { level: "verified", label: "V√©rifi√© (Safe)", score: 0 };
    }

    // Par d√©faut : Faible (mais inconnu)
    return { level: "low", label: "Faible (Inconnu)", score: 1 };
}

/* ------------------------------------------------------------
   6. Mise √† jour de l'UI selon le niveau de risque
   ------------------------------------------------------------ */

function updateRiskUI(query) {
    const risk = getRiskLevel(query);

    // Reset classes
    riskPill.classList.remove("safe", "low", "moderate", "high", "critical");
    riskPill.classList.add(
        risk.level === "verified" ? "safe" :
        risk.level === "low" ? "low" :
        risk.level === "moderate" ? "moderate" :
        risk.level === "high" ? "high" :
        risk.level === "critical" ? "critical" : "low"
    );

    riskLabel.textContent = risk.label;

    // Bouton de recherche : gris√© si "√† RISQUE"
    if (risk.level === "critical") {
        btnSearch.classList.add("disabled");
        btnSearch.disabled = true;
    } else {
        btnSearch.classList.remove("disabled");
        btnSearch.disabled = false;
    }

    // Panel de s√©curit√©
    if (!query.trim()) {
        securityPanel.classList.remove("visible");
        securityBody.innerHTML = "Tape une requ√™te pour voir son niveau de risque.";
        securityTag.textContent = "Analyse en temps r√©el";
        return;
    }

    securityPanel.classList.add("visible");

    let levelClass = "";
    if (risk.level === "verified") levelClass = "safe";
    else if (risk.level === "low") levelClass = "low";
    else if (risk.level === "moderate") levelClass = "moderate";
    else if (risk.level === "high") levelClass = "high";
    else if (risk.level === "critical") levelClass = "critical";

    securityTag.textContent =
        risk.level === "verified" ? "Zone V√©rifi√©e" :
        risk.level === "low" ? "Risque Faible" :
        risk.level === "moderate" ? "Risque Mod√©r√©" :
        risk.level === "high" ? "Risque √âlev√©" :
        "Risque Critique";

    const levelText =
        risk.level === "verified" ? "V√©rifi√© (Safe)" :
        risk.level === "low" ? "Faible" :
        risk.level === "moderate" ? "Mod√©r√©" :
        risk.level === "high" ? "√âlev√©" :
        "√† RISQUE";

    const advisory =
        risk.level === "verified"
            ? "Les termes de cette requ√™te sont consid√©r√©s comme s√ªrs et connus. Tu peux naviguer sereinement."
        : risk.level === "low"
            ? "Cette requ√™te est globalement s√ªre. Reste attentif aux liens sponsoris√©s ou inconnus."
        : risk.level === "moderate"
            ? "Cette requ√™te peut t'exposer √† des arnaques, des faux supports ou des offres trompeuses. V√©rifie toujours l'URL et la source."
        : risk.level === "high"
            ? "Cette requ√™te est associ√©e √† des contenus potentiellement dangereux (malwares, cracks, t√©l√©chargements risqu√©s). Ne t√©l√©charge rien sans certitude."
        : "Cette requ√™te est li√©e √† des activit√©s ill√©gales, du dark web ou des outils de piratage avanc√©s. Le portail bloque la validation.";

    securityBody.innerHTML =
        `Requ√™te analys√©e : <span class="keyword">${escapeHtml(query)}</span><br>` +
        `Niveau de risque : <span class="level ${levelClass}">${levelText}</span><br><br>` +
        advisory;
}

/* ------------------------------------------------------------
   7. Timer d'analyse (0.16s apr√®s arr√™t de frappe)
   ------------------------------------------------------------ */

let analyzeTimer = null;

searchInput.addEventListener('input', () => {
    if (analyzeTimer) clearTimeout(analyzeTimer);
    const value = searchInput.value;

    analyzeTimer = setTimeout(() => {
        updateRiskUI(value);
    }, 160);
});

/* ------------------------------------------------------------
   8. Historique (localStorage)
   ------------------------------------------------------------ */

const HISTORY_KEY = "827scall_search_history";

function loadHistory() {
    try {
        const raw = localStorage.getItem(HISTORY_KEY);
        if (!raw) return [];
        const parsed = JSON.parse(raw);
        if (!Array.isArray(parsed)) return [];
        return parsed;
    } catch (e) {
        return [];
    }
}

function saveHistory(history) {
    try {
        localStorage.setItem(HISTORY_KEY, JSON.stringify(history));
    } catch (e) {
        // ignore
    }
}

function addToHistory(query, riskLevel) {
    if (!query.trim()) return;
    const history = loadHistory();
    const now = new Date();
    const item = {
        query,
        riskLevel,
        timestamp: now.toISOString()
    };
    // On ajoute en t√™te
    history.unshift(item);
    // On limite √† 50 entr√©es
    if (history.length > 50) history.length = 50;
    saveHistory(history);
    renderHistory();
}

function formatTimestamp(ts) {
    try {
        const d = new Date(ts);
        const h = String(d.getHours()).padStart(2, "0");
        const m = String(d.getMinutes()).padStart(2, "0");
        return `${h}:${m}`;
    } catch (e) {
        return "";
    }
}

function renderHistory() {
    const history = loadHistory();
    historyList.innerHTML = "";

    if (history.length === 0) {
        const empty = document.createElement("div");
        empty.style.fontSize = "10px";
        empty.style.color = "rgba(164,168,195,0.8)";
        empty.textContent = "Aucune recherche enregistr√©e pour l'instant.";
        historyList.appendChild(empty);
        return;
    }

    history.forEach((item, index) => {
        const row = document.createElement("div");
        row.className = "history-item";

        const left = document.createElement("div");
        left.className = "history-left";

        const dot = document.createElement("div");
        dot.className = "history-dot";

        if (item.riskLevel === "verified") {
            dot.style.background = "#4dff88";
        } else if (item.riskLevel === "low") {
            dot.style.background = "#4fd1ff";
        } else if (item.riskLevel === "moderate") {
            dot.style.background = "#ffb347";
        } else if (item.riskLevel === "high") {
            dot.style.background = "#ff4b6a";
        } else if (item.riskLevel === "critical") {
            dot.style.background = "#ff0033";
        }

        const text = document.createElement("div");
        text.className = "history-text";
        text.textContent = item.query;

        const meta = document.createElement("div");
        meta.className = "history-meta";
        const levelText =
            item.riskLevel === "verified" ? "V√©rifi√©" :
            item.riskLevel === "low" ? "Faible" :
            item.riskLevel === "moderate" ? "Mod√©r√©" :
            item.riskLevel === "high" ? "√âlev√©" :
            item.riskLevel === "critical" ? "√† RISQUE" : "Inconnu";
        meta.textContent = `${levelText} ‚Ä¢ ${formatTimestamp(item.timestamp)}`;

        left.appendChild(dot);
        left.appendChild(text);
        left.appendChild(meta);

        const remove = document.createElement("div");
        remove.className = "history-remove";
        remove.textContent = "‚úï";
        remove.addEventListener("click", (e) => {
            e.stopPropagation();
            const h = loadHistory();
            h.splice(index, 1);
            saveHistory(h);
            renderHistory();
        });

        row.appendChild(left);
        row.appendChild(remove);

        row.addEventListener("click", () => {
            searchInput.value = item.query;
            updateRiskUI(item.query);
        });

        historyList.appendChild(row);
    });
}

btnHistoryClear.addEventListener("click", () => {
    saveHistory([]);
    renderHistory();
});

/* ------------------------------------------------------------
   9. Fond d'√©cran personnalis√©
   ------------------------------------------------------------ */

const BG_KEY = "827scall_custom_bg";

function loadBackground() {
    try {
        const data = localStorage.getItem(BG_KEY);
        if (!data) {
            bgLayer.style.opacity = "0";
            fallbackAnimation.style.opacity = "1";
            return;
        }
        bgLayer.style.backgroundImage = `url(${data})`;
        bgLayer.classList.add("visible");
        fallbackAnimation.style.opacity = "0";
    } catch (e) {
        // ignore
    }
}

function saveBackground(dataUrl) {
    try {
        localStorage.setItem(BG_KEY, dataUrl);
    } catch (e) {
        // ignore
    }
}

function resetBackground() {
    try {
        localStorage.removeItem(BG_KEY);
    } catch (e) {
        // ignore
    }
    bgLayer.classList.remove("visible");
    bgLayer.style.backgroundImage = "";
    fallbackAnimation.style.opacity = "1";
}

btnBgUpload.addEventListener("click", () => {
    bgFileInput.click();
});

bgFileInput.addEventListener("change", (e) => {
    const file = e.target.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = function(ev) {
        const dataUrl = ev.target.result;
        saveBackground(dataUrl);
        bgLayer.style.backgroundImage = `url(${dataUrl})`;
        bgLayer.classList.add("visible");
        fallbackAnimation.style.opacity = "0";
        // Optionnel : extraire une couleur dominante pour adapter le d√©grad√©
        adaptSearchBarColor(dataUrl);
    };
    reader.readAsDataURL(file);
});

btnBgReset.addEventListener("click", () => {
    resetBackground();
});

/* ------------------------------------------------------------
   10. Adaptation de la couleur de la barre de recherche
   ------------------------------------------------------------ */

function adaptSearchBarColor(dataUrl) {
    const img = new Image();
    img.crossOrigin = "Anonymous";
    img.onload = function() {
        const canvas = document.createElement("canvas");
        const ctx = canvas.getContext("2d");
        canvas.width = 32;
        canvas.height = 32;
        ctx.drawImage(img, 0, 0, 32, 32);
        const data = ctx.getImageData(0, 0, 32, 32).data;
        let r = 0, g = 0, b = 0, count = 0;
        for (let i = 0; i < data.length; i += 4) {
            r += data[i];
            g += data[i + 1];
            b += data[i + 2];
            count++;
        }
        r = Math.round(r / count);
        g = Math.round(g / count);
        b = Math.round(b / count);

        const gradient = `linear-gradient(135deg, rgba(${r},${g},${b},0.18), rgba(10,12,20,0.96))`;
        searchBar.style.background = gradient;
    };
    img.src = dataUrl;
}

/* ------------------------------------------------------------
   11. Pop-up de s√©curit√© (√âlev√©)
   ------------------------------------------------------------ */

let pendingQuery = null;
let pendingRisk = null;

function openSecurityDialog(query) {
    pendingQuery = query;
    pendingRisk = getRiskLevel(query);
    dialogKeyword.textContent = query;
    overlay.classList.add("visible");
}

function closeSecurityDialog() {
    overlay.classList.remove("visible");
    pendingQuery = null;
    pendingRisk = null;
}

dialogCancel.addEventListener("click", () => {
    closeSecurityDialog();
});

overlay.addEventListener("click", (e) => {
    if (e.target === overlay) {
        closeSecurityDialog();
    }
});

dialogConfirm.addEventListener("click", () => {
    if (!pendingQuery) return;
    // On ajoute √† l'historique
    addToHistory(pendingQuery, pendingRisk.level);
    // Redirection vers Google
    redirectToGoogle(pendingQuery);
    closeSecurityDialog();
});

/* ------------------------------------------------------------
   12. Redirection vers Google
   ------------------------------------------------------------ */

function redirectToGoogle(query) {
    const encoded = encodeURIComponent(query);
    const url = `https://www.google.com/search?q=${encoded}`;
    window.location.href = url;
}

/* ------------------------------------------------------------
   13. Gestion de la recherche (bouton + Entr√©e)
   ------------------------------------------------------------ */

function handleSearch() {
    const query = searchInput.value.trim();
    if (!query) return;

    const risk = getRiskLevel(query);

    if (risk.level === "critical") {
        // Bouton d√©j√† gris√©, on ne valide pas
        return;
    }

    if (risk.level === "high") {
        // Pop-up de confirmation
        openSecurityDialog(query);
        return;
    }

    // Ajout √† l'historique
    addToHistory(query, risk.level);

    // Redirection directe
    redirectToGoogle(query);
}

btnSearch.addEventListener("click", () => {
    if (btnSearch.disabled) return;
    handleSearch();
});

searchInput.addEventListener("keydown", (e) => {
    if (e.key === "Enter") {
        const risk = getRiskLevel(searchInput.value);
        if (risk.level === "critical") {
            // Entr√©e gris√©e symboliquement : on bloque
            e.preventDefault();
            return;
        }
        e.preventDefault();
        handleSearch();
    }
});

/* ------------------------------------------------------------
   14. Utilitaires
   ------------------------------------------------------------ */

function escapeHtml(str) {
    return str
        .replace(/&/g, "&amp;")
        .replace(/</g, "&lt;")
        .replace(/>/g, "&gt;");
}

/* ------------------------------------------------------------
   15. Initialisation
   ------------------------------------------------------------ */

function init() {
    loadBackground();
    renderHistory();
    updateRiskUI("");
}

document.addEventListener("DOMContentLoaded", init);
</script>
</body>
</html>
